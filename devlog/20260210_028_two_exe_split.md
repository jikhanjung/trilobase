# 작업 로그 028: EXE 두 개 분리 (GUI / MCP stdio)

**작업일:** 2026-02-10
**브랜치:** `feature/scoda-implementation`
**계획 문서:** `devlog/20260210_P19_two_exe_split.md`

## 배경

`console=True` 단일 EXE의 문제:
- GUI 실행 시 PowerShell/cmd.exe가 프로세스 종료까지 블로킹
- `console=False`로 변경 시 PyInstaller 부트로더가 stdin/stdout을 NUL로 교체 → MCP stdio 통신 불가

## 변경 내용

### `scripts/gui.py`

`main()` 함수를 GUI 전용으로 단순화:
- `argparse` 전체 제거
- `--mcp-stdio` 분기 제거
- `ShowWindow` 제거 (`console=False`이므로 불필요)

**변경 후 main():**
```python
def main():
    try:
        gui = TrilobaseGUI()
        gui.run()
    except Exception as e:
        ...
```

### `trilobase.spec`

단일 EXE → 두 개로 분리:

**`trilobase.exe` (GUI):**
- `Analysis` 진입점: `scripts/gui.py`
- `console=False` (GUI subsystem, 콘솔 블로킹 없음)
- `datas`: `app.py`, `templates`, `static`, `trilobase.db`
- MCP 관련 hiddenimports 제거

**`trilobase_mcp.exe` (MCP stdio):**
- `Analysis` 진입점: `mcp_server.py`
- `console=True` (stdin/stdout MCP 통신 필수)
- `datas`: `trilobase.db` (templates/static 불필요)
- MCP/starlette/uvicorn hiddenimports 포함

### `mcp_server.py`

변경 없음. `__main__` → `main()` → 기본 stdio 모드로 동작.

## 결과

| 실행 방법 | 동작 |
|----------|------|
| `trilobase.exe` (더블클릭) | 콘솔 없이 GUI 실행 |
| `trilobase.exe` (PowerShell) | 즉시 반환, 백그라운드 GUI 실행 |
| `trilobase_mcp.exe` | MCP stdio 서버 실행 (인자 불필요) |

## Claude Desktop 설정 (업데이트)

```json
{
  "mcpServers": {
    "trilobase": {
      "command": "C:\\path\\to\\trilobase_mcp.exe"
    }
  }
}
```

`args` 항목 불필요.

## 빌드 방법

```bash
pyinstaller trilobase.spec
```

`dist/trilobase.exe` 와 `dist/trilobase_mcp.exe` 두 파일 생성.
